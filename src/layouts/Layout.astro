---
import '../styles/global.css';
import Logo from '../components/Logo.astro';
import StructuredData from '../components/StructuredData.astro';
import Breadcrumbs from '../components/Breadcrumbs.astro';
import AuthorBio from '../components/AuthorBio.astro';

interface Props {
 title?: string;
 description?: string;
}

const {
 title = 'AI Website Builders - What I Actually Found After 127 Hours of Testing',
 description = 'Hands-on testing of AI website builders. Honest reviews, real results, and actual findings from 127+ hours of building real sites.',
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);

// Generate breadcrumbs
const pathSegments = Astro.url.pathname.split('/').filter(Boolean);
const breadcrumbs = [{ name: 'Home', url: 'https://aiwebsitebuilders.com/' }];
let currentPath = '';
for (const segment of pathSegments) {
  currentPath += `/${segment}`;
  const name = segment
    .split('-')
    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
    .join(' ');
  breadcrumbs.push({ name, url: `https://aiwebsitebuilders.com${currentPath}` });
}
---

<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="canonical" href={canonicalURL} />
  <meta name="description" content={description} />

  <!-- Schema.org Structured Data -->
  <StructuredData type="Organization" />
  <StructuredData type="BreadcrumbList" data={{ breadcrumbs }} />

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content={canonicalURL} />
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:image" content="https://aiwebsitebuilders.com/og-image.svg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="AI Website Builders - 127 Hours of Testing" />

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content={canonicalURL} />
  <meta property="twitter:title" content={title} />
  <meta property="twitter:description" content={description} />
  <meta property="twitter:image" content="https://aiwebsitebuilders.com/og-image.svg" />

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

  <!-- Web App Manifest -->
  <link rel="manifest" href="/manifest.json" />

  <!-- Google Analytics 4 (Low priority, non-blocking) -->
  <!-- TODO: Replace G-XXXXXXXXXX with actual GA4 Measurement ID -->
  <script is:inline src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX" fetchpriority="low"></script>
  <script is:inline fetchpriority="low">
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXXXXX');
  </script>

  <!-- Preconnect for fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet" />

  <title>{title}</title>
 </head>
 <body class="bg-white text-gray-900">
  <!-- Navigation - Premium distinctive with animated underlines -->
  <nav class="sticky top-0 z-50 bg-white/90 backdrop-blur-xl border-b border-gray-200/60 shadow-[0_2px_0_0_rgba(0,0,0,0.1)] supports-[backdrop-filter]:bg-white/75">
   <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
     <!-- Logo -->
     <a href="/" class="flex items-center gap-2.5 group">
      <div class="relative w-9 h-9">
       <div class="absolute inset-0 bg-gradient-to-br from-indigo-600 to-sky-500 rotate-3 group-hover:rotate-0 transition-all duration-300 shadow-[0_4px_0_0_rgba(79,70,229,0.2)]"></div>
       <span class="absolute inset-0 flex items-center justify-center text-white font-black text-base">AI</span>
      </div>
      <div class="hidden sm:block">
       <span class="font-black text-gray-900 group-hover:text-indigo-600 transition-colors text-sm">AI Builders</span>
       <span class="text-gray-400 ml-0.5 text-xs">Reviewed</span>
      </div>
     </a>

     <!-- Desktop Navigation -->
     <div class="hidden lg:flex items-center gap-1">
      <a href="/reviews" class="group nav-link relative px-4 py-2 text-gray-600 hover:text-gray-900 font-medium text-sm transition-all duration-200" aria-label="View all AI website builder reviews">
       Reviews
       <span class="absolute bottom-1 left-4 right-4 h-0.5 bg-indigo-600 scale-x-0 group-hover:scale-x-100 transition-transform duration-200 origin-left"></span>
      </a>
      <a href="/guides" class="group nav-link relative px-4 py-2 text-gray-600 hover:text-gray-900 font-medium text-sm transition-all duration-200" aria-label="View guides and tutorials">
       Guides
       <span class="absolute bottom-1 left-4 right-4 h-0.5 bg-indigo-600 scale-x-0 group-hover:scale-x-100 transition-transform duration-200 origin-left"></span>
      </a>
      <a href="/comparisons" class="group nav-link relative inline-flex items-center px-3 py-2 text-gray-600 hover:text-gray-900 font-medium text-sm transition-all duration-200" aria-label="View AI builder comparisons">
       Comparisons
       <span class="ml-1.5 px-1.5 py-0.5 bg-gradient-to-r from-indigo-600 to-sky-500 text-white text-[10px] font-black shadow-[0_2px_0_0_rgba(0,0,0,0.1)] shadow-indigo-500/20">New</span>
       <span class="absolute bottom-1 left-4 right-4 h-0.5 bg-indigo-600 scale-x-0 group-hover:scale-x-100 transition-transform duration-200 origin-left"></span>
      </a>
     </div>

     <!-- Right side -->
     <div class="flex items-center gap-3">
      <!-- Testing badge with pulse animation -->
      <div class="hidden md:flex items-center gap-2 px-3 py-1.5 bg-gray-50 border-[3px] border-gray-200 hover:border-orange-200 hover:bg-orange-50/50 transition-all duration-200">
       <div class="relative">
        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
        <div class="absolute inset-0 w-2 h-2 bg-green-500 rounded-full animate-ping opacity-75"></div>
       </div>
       <span class="text-xs text-gray-600"><span class="font-black text-gray-900">127h</span> tested</span>
      </div>

      <!-- CTA -->
      <a href="/guides/how-to-choose" class="hidden md:inline-flex items-center justify-center gap-1.5 px-5 py-2 bg-gradient-to-r from-indigo-600 to-sky-500 text-white font-black border-[3px] border-indigo-700 shadow-[0_4px_0_0_rgba(0,0,0,0.2)] hover:shadow-[0_6px_0_0_rgba(0,0,0,0.25)] hover:-translate-y-0.5 transition-all duration-200 text-sm">
       Choose the Right One
       <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
       </svg>
      </a>

      <!-- Mobile menu button -->
      <button id="mobile-menu-button" class="lg:hidden p-2 border-[3px] border-transparent hover:border-gray-200 hover:bg-gray-50 transition-all" aria-label="Open menu" data-mobile-menu-toggle>
       <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
       </svg>
      </button>
     </div>
    </div>

    <!-- Mobile Menu Panel -->
    <div id="mobile-menu" class="hidden lg:hidden bg-white border-b border-gray-200 shadow-lg" data-mobile-menu>
      <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <nav class="flex flex-col space-y-3">
          <a href="/reviews" class="px-4 py-2 text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors font-medium">
            Reviews
          </a>
          <a href="/guides" class="px-4 py-2 text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors font-medium">
            Guides
          </a>
          <a href="/comparisons" class="px-4 py-2 text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors font-medium">
            Comparisons
          </a>
          <a href="/guides/how-to-choose" class="px-4 py-2 bg-gradient-to-r from-indigo-600 to-sky-500 text-white rounded-lg font-black text-center shadow-[0_4px_0_0_rgba(0,0,0,0.2)]">
            Choose the Right One
          </a>
        </nav>
      </div>
    </div>
   </div>
  </nav>

  <script>
    // Mobile menu toggle functionality
    (function() {
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const mobileMenu = document.getElementById('mobile-menu');

      if (mobileMenuButton && mobileMenu) {
        mobileMenuButton.addEventListener('click', () => {
          mobileMenu.classList.toggle('hidden');
        });
      }
    })();
  </script>

  <!-- Breadcrumbs -->
  <Breadcrumbs breadcrumbs={breadcrumbs} />

  <!-- Main Content -->
  <main>
   <slot />
  </main>

  <!-- Footer - Premium distinctive -->
  <footer class="bg-gradient-to-br from-gray-900 via-gray-900 to-black text-gray-300 mt-32 relative overflow-hidden">
   <!-- Animated background decoration -->
   <div class="absolute inset-0">
    <div class="absolute top-0 left-1/4 w-[600px] h-[600px] blur-3xl opacity-10 animate-pulse" style="background: radial-gradient(circle, #F5521A 0%, transparent 70%); animation-duration: 8s;"></div>
    <div class="absolute bottom-0 right-1/4 w-[600px] h-[600px] blur-3xl opacity-10 animate-pulse" style="background: radial-gradient(circle, #6366f1 0%, transparent 70%); animation-duration: 12s; animation-delay: 2s;"></div>
   </div>

   <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-20 relative">
    <!-- Newsletter CTA - Enhanced -->
    <div class="max-w-3xl mx-auto mb-20">
     <div class="relative bg-gradient-to-br from-gray-800/50 to-gray-900/50 backdrop-blur-xl border-[3px] border-gray-700/50 p-8 md:p-10 overflow-hidden">
      <!-- Accent decoration -->
      <div class="absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-orange-500/10 to-transparent blur-3xl"></div>

      <div class="relative">
       <!-- Badge -->
       <div class="inline-flex items-center gap-2 px-3 py-1.5 bg-indigo-500/10 border border-indigo-500/20 mb-6">
        <div class="relative">
         <div class="w-1.5 h-1.5 bg-indigo-500 "></div>
         <div class="absolute inset-0 w-1.5 h-1.5 bg-indigo-500 animate-ping opacity-75"></div>
        </div>
        <span class="text-xs font-black text-indigo-400">Weekly Testing Notes</span>
       </div>

       <h2 class="text-2xl md:text-3xl font-black text-white mb-3">Don't pick the wrong builder</h2>
       <p class="text-gray-400 mb-8 text-lg">Get raw test results, honest findings, and data I never publish publicly. Unfiltered insights.</p>

       <form class="flex flex-col sm:flex-row gap-3 max-w-lg mx-auto">
        <input
         type="email"
         placeholder="your@email.com"
         class="flex-1 px-5 py-3.5 bg-white/5 border-[3px] border-gray-600/50 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent hover:border-gray-500 transition-all"
         required
        />
        <button type="submit" class="inline-flex items-center justify-center gap-2 px-6 py-3.5 bg-gradient-to-r from-indigo-600 to-sky-500 text-white font-black border-[3px] border-indigo-700 shadow-[0_4px_0_0_rgba(0,0,0,0.2)] hover:shadow-[0_6px_0_0_rgba(0,0,0,0.25)] hover:-translate-y-0.5 transition-all duration-200 whitespace-nowrap" aria-label="Subscribe to weekly testing notes">
         Get Weekly Notes
         <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
         </svg>
        </button>
       </form>

       <!-- Social proof -->
       <div class="flex items-center justify-center gap-6 mt-6 text-sm">
        <div class="flex items-center gap-2">
         <div class="flex -space-x-2">
          <div class="w-8 h-8 bg-gradient-to-br from-orange-400 to-orange-600 border-2 border-gray-800 flex items-center justify-center text-white text-xs font-black">JD</div>
          <div class="w-8 h-8 bg-gradient-to-br from-blue-400 to-blue-600 border-2 border-gray-800 flex items-center justify-center text-white text-xs font-black">SK</div>
          <div class="w-8 h-8 bg-gradient-to-br from-green-400 to-green-600 border-2 border-gray-800 flex items-center justify-center text-white text-xs font-black">MR</div>
         </div>
         <span class="text-gray-400">Join <span class="font-black text-white">500+</span> builders</span>
        </div>
        <span class="text-gray-600">•</span>
        <span class="text-gray-500">Unsubscribe anytime</span>
       </div>
      </div>
     </div>
    </div>

    <!-- Author Bio Section - Authentic presence -->
    <div class="max-w-4xl mx-auto mb-16">
     <AuthorBio variant="compact" />
    </div>

    <!-- Main footer links -->
    <div class="grid grid-cols-2 md:grid-cols-5 gap-10 mb-16">
     <!-- Brand -->
     <div class="col-span-2">
      <a href="/" class="inline-block mb-5">
       <div class="flex items-center gap-2.5">
        <div class="relative w-10 h-10">
         <div class="absolute inset-0 bg-gradient-to-br from-orange-500 to-orange-600 rotate-3"></div>
         <span class="absolute inset-0 flex items-center justify-center text-white font-black text-base">AI</span>
        </div>
        <div>
         <div class="text-lg font-black text-white">AI Builders</div>
         <div class="text-xs text-gray-500">Reviewed</div>
        </div>
       </div>
      </a>
      <p class="text-gray-400 leading-relaxed mb-6 max-w-sm text-sm">
       The problem with AI website builder reviews? They're all trying to sell you something. I'm not. I test them and tell you what actually happens.
      </p>

      <!-- Trust badges -->
      <div class="flex flex-wrap gap-3 mb-6">
       <div class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-white/5 border border-white/10 ">
        <svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span class="text-xs text-gray-400">Honest reviews</span>
       </div>
       <div class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-white/5 border border-white/10 ">
        <svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span class="text-xs text-gray-400">Real testing</span>
       </div>
      </div>

      <div class="flex items-center gap-5 text-sm">
       <a href="/methodology" class="text-gray-400 hover:text-white transition-colors">Methodology</a>
       <a href="/about" class="text-gray-400 hover:text-white transition-colors">About</a>
      </div>
     </div>

     <!-- Reviews -->
     <div>
      <h3 class="font-black text-white mb-4 text-sm tracking-wide uppercase">Reviews</h3>
      <ul class="space-y-2.5">
       <li><a href="/reviews/framer-ai" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">Framer AI Review</a></li>
       <li><a href="/reviews/10web-ai" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">10Web AI Review</a></li>
       <li><a href="/reviews/durable-ai" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">Durable AI Review</a></li>
       <li><a href="/reviews/relume-ai" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">Relume AI Review</a></li>
       <li><a href="/reviews" class="text-orange-400 hover:text-orange-300 font-black transition-colors mt-1 inline-flex items-center gap-1 text-sm">View all <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></a></li>
      </ul>
     </div>

     <!-- Guides -->
     <div>
      <h3 class="font-black text-white mb-4 text-sm tracking-wide uppercase">Guides</h3>
      <ul class="space-y-2.5">
       <li><a href="/guides/how-to-choose" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">How to Choose</a></li>
       <li><a href="/guides/best-ai-website-builders-2025" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">Best of 2025</a></li>
       <li><a href="/guides/free-ai-website-builders" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">Free Plans</a></li>
       <li><a href="/guides/common-mistakes" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">Common Mistakes</a></li>
       <li><a href="/guides" class="text-orange-400 hover:text-orange-300 font-black transition-colors mt-1 inline-flex items-center gap-1 text-sm">View all <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></a></li>
      </ul>
     </div>

     <!-- Comparisons -->
     <div>
      <h3 class="font-black text-white mb-4 text-sm tracking-wide uppercase">Comparisons</h3>
      <ul class="space-y-2.5">
       <li><a href="/comparisons/framer-vs-durable" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">Framer vs Durable</a></li>
       <li><a href="/comparisons/10web-vs-framer" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">10Web vs Framer</a></li>
       <li><a href="/comparisons/durable-vs-10web" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">Durable vs 10Web</a></li>
       <li><a href="/comparisons/wix-vs-squarespace" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">Wix vs Squarespace</a></li>
       <li><a href="/comparisons" class="text-orange-400 hover:text-orange-300 font-black transition-colors mt-1 inline-flex items-center gap-1 text-sm">View all <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></a></li>
      </ul>
     </div>

     <!-- By Use Case -->
     <div>
      <h3 class="font-black text-white mb-4 text-sm tracking-wide uppercase">By Use Case</h3>
      <ul class="space-y-2.5">
       <li><a href="/guides/ai-builders-for-ecommerce" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">E-commerce</a></li>
       <li><a href="/guides/ai-website-builder-for-beginners" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">For Beginners</a></li>
       <li><a href="/guides/ai-website-builder-for-landing-pages" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">Landing Pages</a></li>
       <li><a href="#" class="text-gray-400 hover:text-orange-400 transition-colors text-sm">For Agencies</a></li>
       <li><a href="/guides" class="text-orange-400 hover:text-orange-300 font-black transition-colors mt-1 inline-flex items-center gap-1 text-sm">View all <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></a></li>
      </ul>
     </div>
    </div>

    <!-- Bottom bar - Enhanced -->
    <div class="border-t border-white/10 pt-8">
     <div class="flex flex-col md:flex-row justify-between items-center gap-4">
      <p class="text-sm text-gray-500">
       © {new Date().getFullYear()} AI Builders Reviewed. All rights reserved.
      </p>
      <div class="flex items-center gap-5 text-sm">
       <span class="flex items-center gap-2 text-gray-500 hover:text-gray-400 transition-colors cursor-help" title="I actually use these tools before reviewing them">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span>Real testing</span>
       </span>
       <span class="flex items-center gap-2 text-gray-500">
        <div class="relative">
         <div class="w-2 h-2 bg-green-500 "></div>
         <div class="absolute inset-0 w-2 h-2 bg-green-500 animate-ping opacity-75"></div>
        </div>
        <span>Updated January 2025</span>
       </span>
      </div>
     </div>
    </div>
   </div>
  </footer>

  <!-- Affiliate Link Tracking - Automatic gtag events for all affiliate links -->
  <script is:inline>
    (function() {
      'use strict';

      /**
       * Affiliate Link Tracking
       * Automatically tracks clicks on affiliate links with Google Analytics
       */
      function initAffiliateTracking() {
        // Affiliate domains to track
        const affiliateDomains = [
          '10web.io', 'framer.com', 'durable.co', 'webflow.com', 'wix.com',
          'squarespace.com', 'hostinger.com', 'relume.io', 'dorik.com',
          'bookmark.com', 'teleporthq.io', 'b12.io', 'mixo.io',
          'pineapplebuilder.com', 'codewp.ai', 'unicornplatform.com',
          'codedesign.ai', 'godaddy.com', 'ionos.com', 'jimdo.com',
          'site123.com', 'namecheap.com', 'web.com', 'strikingly.com',
          'zyro.com', 'wordpress.com'
        ];

        // Tool name mapping
        const toolMapping = {
          '10web.io': '10Web',
          'framer.com': 'Framer',
          'durable.co': 'Durable',
          'webflow.com': 'Webflow',
          'wix.com': 'Wix',
          'squarespace.com': 'Squarespace',
          'hostinger.com': 'Hostinger',
          'relume.io': 'Relume',
          'dorik.com': 'Dorik',
          'bookmark.com': 'Bookmark',
          'teleporthq.io': 'TeleportHQ',
          'b12.io': 'B12',
          'mixo.io': 'Mixo',
          'pineapplebuilder.com': 'Pineapple Builder',
          'codewp.ai': 'CodeWP',
          'unicornplatform.com': 'Unicorn Platform',
          'codedesign.ai': 'CodeDesign.ai',
          'godaddy.com': 'GoDaddy',
          'ionos.com': 'IONOS',
          'jimdo.com': 'Jimdo',
          'site123.com': 'Site123',
          'namecheap.com': 'Namecheap',
          'web.com': 'web.com',
          'strikingly.com': 'Strikingly',
          'zyro.com': 'Zyro',
        };

        // Extract tool name from URL
        function getToolName(url) {
          try {
            const hostname = new URL(url).hostname;
            for (const [domain, toolName] of Object.entries(toolMapping)) {
              if (hostname.includes(domain)) return toolName;
            }
            return 'Unknown';
          } catch {
            return 'Unknown';
          }
        }

        // Check if URL is affiliate link
        function isAffiliateUrl(url) {
          try {
            const hostname = new URL(url).hostname;
            return affiliateDomains.some(domain => hostname.includes(domain));
          } catch {
            return false;
          }
        }

        // Get link location context
        function getLinkLocation(element) {
          if (element.hasAttribute('data-location')) {
            return element.getAttribute('data-location');
          }

          const parent = element.closest('section, div, article, footer, nav');
          if (parent) {
            const classes = parent.className;
            if (classes.includes('hero')) return 'hero';
            if (classes.includes('cta')) return 'cta-section';
            if (classes.includes('sidebar')) return 'sidebar';
            if (classes.includes('footer')) return 'footer';
            if (classes.includes('comparison')) return 'comparison';
            if (classes.includes('testimonial')) return 'testimonial';
          }

          return 'body';
        }

        // Track affiliate click
        function trackAffiliateClick(href, element) {
          if (typeof gtag === 'undefined') return;

          const toolName = getToolName(href);
          const location = getLinkLocation(element);

          gtag('event', 'affiliate_click', {
            tool_name: toolName,
            location: location,
            page_path: window.location.pathname,
            page_title: document.title,
            link_url: href,
            send_to: 'default'
          });

          console.log('[Affiliate Tracking] Click:', toolName, location);
        }

        // Add tracking to all affiliate links
        const links = document.querySelectorAll('a[href]');
        let trackedCount = 0;

        links.forEach(link => {
          const href = link.getAttribute('href');
          if (!href || href.startsWith('#') || href.startsWith('/')) return;

          if (isAffiliateUrl(href)) {
            link.addEventListener('click', function() {
              trackAffiliateClick(href, this);
            });
            trackedCount++;
          }
        });

        console.log('[Affiliate Tracking] Initialized. Tracked ' + trackedCount + ' links.');

        // Track affiliate impressions (tools shown on page)
        if (typeof gtag !== 'undefined' && trackedCount > 0) {
          const toolsSeen = new Set();
          links.forEach(link => {
            const href = link.getAttribute('href');
            if (href && isAffiliateUrl(href)) {
              toolsSeen.add(getToolName(href));
            }
          });

          if (toolsSeen.size > 0) {
            gtag('event', 'affiliate_impression', {
              tools: Array.from(toolsSeen),
              tool_count: toolsSeen.size,
              page_path: window.location.pathname,
              send_to: 'default'
            });
          }
        }
      }

      // Initialize on page load
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initAffiliateTracking);
      } else {
        initAffiliateTracking();
      }

      // Re-initialize for dynamic content
      const lastUrl = location.href;
      new MutationObserver(function() {
        if (location.href !== lastUrl) {
          initAffiliateTracking();
        }
      }).observe(document.body, { childList: true, subtree: true });
    })();
  </script>
 </body>
</html>
